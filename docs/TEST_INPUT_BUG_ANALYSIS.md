# 🐛 ניתוח בעיית קלט בטסטים

## הבעיה

בטסטים, משתמשים מקלידים שמות ערים (כמו "תל אביב") כאשר הם אמורים להקליד מספרי בחירה.

## דוגמה מהלוגים

```
⏰ 2025-11-22T00:11:51.471113
📤 OUTGOING
🔹 State: ask_hitchhiker_when_need_ride
💬 Message:
   בסדר! 🚶💨
   למתי אתה צריך את הטרמפ?
   1. ⚡ ממש עכשיו
   2. ⏰ בחצי שעה הקרובה
   3. ⏱️ בשעה הקרובה
   4. 🕐 בשעות הקרובות (2-5 שעות)

────────────────────────────────────────────────────────────────────────────────
⏰ 2025-11-22T00:11:51.527051
📥 INCOMING
💬 Message: תל אביב  <-- שם עיר במקום מספר!

────────────────────────────────────────────────────────────────────────────────
⏰ 2025-11-22T00:11:51.528136
📤 OUTGOING
🔹 State: ask_hitchhiker_when_need_ride
💬 Message: בחירה לא חוקית. אנא בחר אחת מהאפשרויות: 1, 2, 3, 4
```

## ניתוח

בקובץ `test_integration_inputs.yml` יש:

```yaml
action_messages:
  - "שלום"       # מציג תפריט
  - "1"          # Looking for ride -> עובר ל-ask_hitchhiker_when_need_ride
  - "1"          # Now (ממש עכשיו) - אמור לבחור זמן
  - "תל אביב"   # יעד
```

אבל בלוגים רואים:
1. הודעה "1" אחת בלבד
2. הודעה "תל אביב" (במקום "1" שני)

## הסבר

ההודעה השנייה של "1" **לא מגיעה** או **נבלעת**.

סיבות אפשריות:
1. **Delay לא מספיק** - הקוד משתמש ב-`time.sleep(0.05)` אבל אולי זה לא מספיק
2. **הודעות זהות ברצף** - אולי יש בעיה בעיבוד הודעות זהות
3. **מצב לא נשמר** - המצב לא מתעדכן מספיק מהר

## הפתרון

אני חושב שהבעיה היא ש-**delay של 0.05 שניות לא מספיק** למצב להתעדכן.

צריך להגדיל את ה-delay או להוסיף המתנה למצב הנכון.

