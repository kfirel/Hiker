flow_version: '1.0'
description: Hiker chatbot conversation flow for hitchhikers and drivers
states:
  initial:
    id: initial
    condition: user_not_registered
    # Automatically use WhatsApp name and go directly to user type selection
    # This is handled in conversation_engine.py
    next_state: ask_user_type
  confirm_whatsapp_name:
    id: confirm_whatsapp_name
    # Deprecated - kept for backward compatibility but should not be reached
    message: '×”×™×™ {whatsapp_name}! ğŸ‘‹ ×‘×¨×•×›×™× ×”×‘××™× ×œ×”×™×™×§×¨ ğŸš—âœ¨


      ×”×‘×•×˜ ×”×—×›× ×©×œ ×™×©×•×‘ ×’×‘×¨×¢× ×©×™×¢×–×•×¨ ×œ×š ×œ××¦×•× ×˜×¨××¤×™× ××• ×œ×ª×ª ×˜×¨××¤×™×! ğŸ˜„


      ×‘×•××• × ×›×™×¨! ××¦××ª×™ ××ª ×”×©× ×©×œ×š ×‘-WhatsApp: *{whatsapp_name}*

      ×”×× ×œ×”×©×ª××© ×‘×©× ×”×–×” ××• ×œ×”×§×œ×™×“ ×©× ××—×¨?


      1. âœ… ×›×Ÿ, ×œ×”×©×ª××© ×‘-{whatsapp_name}

      2. âœï¸ ×œ×, ×œ×”×§×œ×™×“ ×©× ××—×¨'
    expected_input: choice
    options:
      '1':
        label: âœ… ×›×Ÿ, ×œ×”×©×ª××© ×‘×©× ×-WhatsApp
        value: 'use_whatsapp_name'
        action: save_whatsapp_name_as_full_name
        next_state: ask_user_type
      '2':
        label: âœï¸ ×œ×, ×œ×”×§×œ×™×“ ×©× ××—×¨
        value: 'enter_different_name'
        next_state: ask_full_name
  ask_full_name:
    id: ask_full_name
    # Deprecated - kept for backward compatibility but should not be reached
    message: '×”×™×™{whatsapp_name}! ğŸ‘‹ ×‘×¨×•×›×™× ×”×‘××™× ×œ×”×™×™×§×¨ ğŸš—âœ¨


      ×”×‘×•×˜ ×”×—×›× ×©×œ ×™×©×•×‘ ×’×‘×¨×¢× ×©×™×¢×–×•×¨ ×œ×š ×œ××¦×•× ×˜×¨××¤×™× ××• ×œ×ª×ª ×˜×¨××¤×™×! ğŸ˜„


      ×‘×•××• × ×›×™×¨! ××” ×”×©× ×”××œ× ×©×œ×š?

      (×”×©× ×™×¢×–×•×¨ ×œ× ×”×’×™× ×•×˜×¨××¤×™×¡×˜×™× ×œ×–×”×•×ª ××•×ª×š) ğŸ­'
    expected_input: text
    save_to: full_name
    action: set_gevaram_as_home
    next_state: ask_user_type
  ask_user_type:
    id: ask_user_type
    message: '×”×™×™ {whatsapp_name}! ğŸ‘‹ ×‘×¨×•×›×™× ×”×‘××™× ×œ×”×™×™×§×¨ ğŸš—âœ¨


      ×”×‘×•×˜ ×”×—×›× ×©×œ ×™×©×•×‘ ×’×‘×¨×¢× ×©×™×¢×–×•×¨ ×œ×š ×œ××¦×•× ×˜×¨××¤×™× ××• ×œ×ª×ª ×˜×¨××¤×™×! ğŸ˜„


      ××™ ××ª×” ×‘×¢×•×œ× ×”×˜×¨××¤×™×?


      1. ğŸš¶ ×˜×¨××¤×™×¡×˜ (××—×¤×© ×˜×¨××¤×™×)

      2. ğŸš— × ×”×’ (× ×•×ª×Ÿ ×˜×¨××¤×™×)'
    expected_input: choice
    action: set_gevaram_as_home
    options:
      '1':
        label: ğŸš¶ ×˜×¨××¤×™×¡×˜
        value: hitchhiker
        next_state: ask_looking_for_ride_now
      '2':
        label: ğŸš— × ×”×’
        value: driver
        next_state: ask_has_routine
    save_to: user_type
  ask_looking_for_ride_now:
    id: ask_looking_for_ride_now
    message: '××•×§×™×™ ×˜×¨××¤×™×¡×˜ ×©×œ×™! ğŸ‘


      ×”×©××œ×” ×”×—×©×•×‘×” - ××ª×” ×ª×§×•×¢ ×¢×›×©×™×• ×•××—×¤×© ×˜×¨××¤? ğŸƒâ€â™‚ï¸ğŸ’¨


      1. âœ… ×›×Ÿ! ×¦×¨×™×š ×¢×–×¨×” ×¢×›×©×™×•

      2. â° ×œ×, ×¨×§ ×œ×”×™×¨×©× ×œ×¢×ª×™×“'
    expected_input: choice
    options:
      '1':
        label: âœ… ×›×Ÿ, ×¢×›×©×™×•!
        value: 'yes'
        next_state: ask_hitchhiker_when_need_ride
      '2':
        label: â° ×œ×, ×××•×—×¨ ×™×•×ª×¨
        value: 'no'
        next_state: ask_set_default_destination
  ask_destination:
    id: ask_destination
    message: '×‘×¡×“×¨ ×’××•×¨! ğŸ¯


      ×œ××™×¤×” ××ª×” ×¦×¨×™×š ×œ×”×’×™×¢? ğŸ—ºï¸


      (×¤×©×•×˜ ×›×ª×•×‘ ××ª ×©× ×”×™×¢×“)

      ğŸ’¡ ×œ××©×œ: ×™×¨×•×©×œ×™×, ×ª×œ ××‘×™×‘, ×—×™×¤×”, ×‘××¨ ×©×‘×¢...'
    expected_input: text
    save_to: destination
    next_state: ask_when
  ask_when:
    id: ask_when
    message: "××¦×•×™×Ÿ! \U0001F44C\n\n××– ××ª×™ ××ª×” ×¦×¨×™×š ×œ×”×’×™×¢ ×œ-{destination}? â°\n\n1. \U0001F3C3 ×”×™×•×/××—×¨ - ×’××™×© ×¢× ×”×©×¢×•×ª\n  \
      \ (××ª×Ÿ ×˜×•×•×— ×©×¢×•×ª ×¨×—×‘, ×œ××©×œ 08:00-10:00)\n\n2. \U0001F4C5 ×ª××¨×™×š ×•×©×¢×” ××“×•×™×§×™× ×‘×¢×ª×™×“\n   (×œ××©×œ: ×‘×¢×•×“ ×©×‘×•×¢ ×‘-14:30)"
    expected_input: choice
    options:
      '1':
        label: ğŸƒ ×”×™×•×/××—×¨ (×’××™×©)
        value: soon
        next_state: ask_time_range
      '2':
        label: ğŸ“… ×ª××¨×™×š ××“×•×™×§ ×‘×¢×ª×™×“
        value: specific
        next_state: ask_specific_datetime
  ask_time_range:
    id: ask_time_range
    message: '××– ××” ×˜×•×•×— ×”×©×¢×•×ª ×©××ª××™× ×œ×š ×œ×”×’×™×¢ ×œ-{destination}? â°


      ×›×ª×•×‘ ×˜×•×•×— ×©×¢×•×ª ×‘×¤×•×¨××˜:

      ×©×¢×ª ×”×ª×—×œ×”-×©×¢×ª ×¡×™×•×


      ğŸ’¡ ×“×•×’×××•×ª (×”×›×™ ×¤×©×•×˜!):

      â€¢ 7-9 (×¤×©×•×˜ ×©×¢×•×ª - ×”×›×™ ×§×œ! ğŸ˜Š)

      â€¢ 08:00-10:00 (×¤×•×¨××˜ ××œ×)

      â€¢ 14:30-17:00 (×¢× ×“×§×•×ª)


      ğŸ¯ ×˜×™×¤: ×›×›×œ ×©×”×˜×•×•×— ×™×•×ª×¨ ×’××™×© - ×™×•×ª×¨ ×¡×™×›×•×™ ×œ××¦×•× × ×”×’! ğŸ˜‰'
    expected_input: text
    save_to: time_range
    next_state: complete_ride_request
  ask_specific_datetime:
    id: ask_specific_datetime
    message: '××•×§×™×™, ××– ××” ×”×ª××¨×™×š ×•×”×©×¢×” ×œ×”×’×™×¢ ×œ-{destination}? ğŸ“…â°


      ×›×ª×•×‘ ×‘×¤×•×¨××˜ ×”×–×”:

      ×™×•×/×—×•×“×©/×©× ×” ×©×¢×”:×“×§×•×ª


      ğŸ’¡ ×“×•×’×××•×ª:

      â€¢ 15/11/2025 14:30

      â€¢ 20/12/2025 08:00

      â€¢ ××—×¨ 10:00 (×–×” ×’× ×¢×•×‘×“! ğŸ˜Š)'
    expected_input: text
    save_to: specific_datetime
    next_state: complete_ride_request
  complete_ride_request:
    id: complete_ride_request
    message: '×™××œ×œ×”! ğŸ‰ ×”×‘×§×©×” ×©×œ×š × ×¨×©××” ×‘××¢×¨×›×ª!


      ğŸ“‹ ×”××™×“×¢ ×©×œ×š:

      {user_summary}


      ×× ×™ ×›×‘×¨ ××—×¤×© ×œ×š × ×”×’ ××ª××™×... ğŸ”ğŸš—


      ×‘×¨×’×¢ ×©×××¦× ××™×©×”×• - ×ª×§×‘×œ ×”×ª×¨××”! ğŸ“²'
    action: save_ride_request
    next_state: check_if_also_driver
  check_if_also_driver:
    id: check_if_also_driver
    # Removed user_type_is_both condition - always go to registration_complete
    next_state: registration_complete
  ask_set_default_destination:
    id: ask_set_default_destination
    message: '×‘×¡×“×¨ ×’××•×¨! ğŸ‘


      ×× ×™ ×›××Ÿ ×‘×©×‘×™×œ×š 24/7! ğŸ’ª


      ×¨×•×¦×” ×œ×”×’×“×™×¨ "×™×¢×“ ××•×¢×“×£"?

      (×–×” ××§×•× ×©××ª×” × ×•×¡×¢ ××œ×™×• ×”×¨×‘×”, ×œ××©×œ: ×¢×‘×•×“×”, ××•× ×™×‘×¨×¡×™×˜×”...)


      âœ… ×”×™×ª×¨×•×Ÿ: ×‘×¤×¢× ×”×‘××” ×œ× ×ª×¦×˜×¨×š ×œ×”×§×œ×™×“ - ×¨×§ ×œ×œ×—×•×¥! âš¡


      1. âœ… ×›×Ÿ, ×‘×•× × ×’×“×™×¨

      2. â­ï¸ ×œ× ×¦×¨×™×š'
    expected_input: choice
    options:
      '1':
        label: âœ… ×›×Ÿ, ×‘×•× × ×’×“×™×¨
        value: 'yes'
        next_state: ask_default_destination_name
      '2':
        label: â­ï¸ ×œ× ×¦×¨×™×š
        value: 'no'
        message: '×‘×¡×“×¨! ğŸ‘


          ×× ×ª×©× ×” ××ª ×“×¢×ª×š, ×ª××™×“ ×ª×•×›×œ ×œ×”×’×“×™×¨ ×™×¢×“ ××•×¢×“×£ ×××•×—×¨ ×™×•×ª×¨ ×“×¨×š ×”×ª×¤×¨×™×˜ (××¤×©×¨×•×ª "×”×¦×’ ××ª ×”××™×“×¢ ×©×œ×™" â†’ "×¢×“×›×Ÿ ×™×¢×“ ××•×¢×“×£").
          ğŸ˜Š'
        next_state: check_if_also_driver
  ask_default_destination_name:
    id: ask_default_destination_name
    message: '××¢×•×œ×”! ğŸ¯


      ××– ××” ×”×™×¢×“ ×”×§×‘×•×¢ ×©×œ×š?


      (×›×ª×•×‘ ×©× ×™×©×•×‘, ×¢×™×¨, ××• ××–×•×¨)

      ğŸ’¡ ×“×•×’×××•×ª: ×™×¨×•×©×œ×™×, ×ª×œ ××‘×™×‘, ×¦×¤×•×Ÿ, ×“×¨×•×, ×©×¤×œ×”...'
    expected_input: text
    save_to: default_destination
    next_state: check_if_also_driver
  ask_has_routine:
    id: ask_has_routine
    message: '××– ×¢×›×©×™×• ×‘×•××• × ×“×‘×¨ ×¢×œ×™×š ×›× ×”×’! ğŸš—ğŸ’¨


      ×™×© ×œ×š ×©×’×¨×ª × ×¡×™×¢×” ×§×‘×•×¢×”?

      (×œ××©×œ: ×›×œ ×™×•× ×œ×¢×‘×•×“×”, ×¤×¢××™×™× ×‘×©×‘×•×¢ ×œ×§× ×™×•×ª...)


      ×©×•× ×“×‘×¨ ××—×™×™×‘! ×–×” ×¨×§ ×›×“×™ ×œ×¢×–×•×¨ ×œ××¦×•× ×œ×š ×˜×¨××¤×™×¡×˜×™× ××ª××™××™× ğŸ˜Š


      1. âœ… ×›×Ÿ, ×™×© ×œ×™ ×©×’×¨×”

      2. âŒ ×œ×, × ×•×¡×¢ ×¡×¤×•× ×˜× ×™'
    expected_input: choice
    options:
      '1':
        label: âœ… ×›×Ÿ, ×™×© ×©×’×¨×”
        value: 'yes'
        next_state: ask_routine_destination
      '2':
        label: âŒ ×œ×, ×¡×¤×•× ×˜× ×™
        value: 'no'
        next_state: ask_alert_frequency
  ask_routine_destination:
    id: ask_routine_destination
    message: '××’× ×™×‘! ğŸ¯


      ××– ×œ××™×¤×” ××ª×” × ×•×¡×¢ ×‘×“×¨×š ×›×œ×œ?


      (×›×ª×•×‘ ×©× ×™×©×•×‘, ×¢×™×¨ ××• ××–×•×¨)

      ğŸ’¡ ×œ××©×œ: ×™×¨×•×©×œ×™×, ×ª×œ ××‘×™×‘, ×¦×¤×•×Ÿ, ×“×¨×•×...'
    expected_input: text
    save_to: routine_destination
    next_state: ask_routine_days
  ask_routine_days:
    id: ask_routine_days
    message: '× ×—××“! ğŸ“…


      ×‘××™×–×” ×™××™× ×‘×©×‘×•×¢ ××ª×” × ×•×¡×¢ ×œ-{routine_destination}?


      ğŸ’¡ ×“×¨×›×™× ×œ×›×ª×•×‘:

      â€¢ ×-×” (×¨××©×•×Ÿ ×¢×“ ×—××™×©×™)

      â€¢ ×,×’,×” (×™××™× ×¡×¤×¦×™×¤×™×™× ×‘×¤×¡×™×§×™×)

      â€¢ ×›×œ ×™×•×

      â€¢ ×¨××©×•×Ÿ ×•×©×œ×™×©×™

      â€¢ ×-×• (×™××™× ××¨×•×›×™×? ğŸ˜…)


      (×›×ª×•×‘ ×‘×›×œ ×“×¨×š ×©× ×•×— ×œ×š!)'
    expected_input: text
    save_to: routine_days
    next_state: ask_routine_departure_time
  ask_routine_departure_time:
    id: ask_routine_departure_time
    message: '××•×§×™×™! â°


      ×‘××™×–×• ×©×¢×” ××ª×” ×‘×“×¨×š ×›×œ×œ ×™×•×¦× ××’×‘×¨×¢× ×œ-{routine_destination}?


      (×¤×©×•×˜ ×›×ª×•×‘ ××ª ×”×©×¢×”, ×œ××©×œ: 07:00 ××• 14:30)'
    expected_input: text
    save_to: routine_departure_time
    next_state: ask_routine_return_time
  ask_routine_return_time:
    id: ask_routine_return_time
    message: '××¢×•×œ×”! ğŸ”„


      ×•×‘××™×–×• ×©×¢×” ××ª×” ×‘×“×¨×š ×›×œ×œ *×™×•×¦×* ×-{routine_destination} ×‘×—×–×¨×”?


      (×œ× ×©×¢×ª ×”×’×¢×” - ××œ× ×‘××™×–×• ×©×¢×” ××ª×” ××ª×—×™×œ ×œ× ×¡×•×¢ ×—×–×¨×”)

      ğŸ’¡ ×œ××©×œ: 18:00


      (×›×Ÿ, ×’× ×‘×“×¨×š ×—×–×¨×” ××¤×©×¨ ×œ×ª×ª ×˜×¨××¤! ğŸ˜Š)'
    expected_input: text
    save_to: routine_return_time
    action: save_routine_and_match
    next_state: ask_another_routine_destination
  ask_another_routine_destination:
    id: ask_another_routine_destination
    message: '××•×©×œ×! ğŸ‘Œ


      ×™×© ×œ×š ×¢×•×“ ×™×¢×“ ×§×‘×•×¢ ×©××ª×” × ×•×¡×¢ ××œ×™×•?

      (×’× ××—×“ × ×•×¡×£ ×–×” ×›×‘×¨ ×”×¨×‘×”! ğŸ’ª)


      1. âœ… ×›×Ÿ, ×™×© ×¢×•×“

      2. âŒ ×œ×, ×–×” ×”×›×œ'
    expected_input: choice
    options:
      '1':
        label: âœ… ×›×Ÿ, ×™×© ×¢×•×“
        value: 'yes'
        next_state: ask_routine_destination
      '2':
        label: âŒ ×œ×, ×–×” ×”×›×œ
        value: 'no'
        next_state: ask_alert_preference
  ask_alert_preference:
    id: ask_alert_preference
    message: "××—×œ×”! ×›××¢×˜ ×¡×™×™×× ×•! \U0001F389\n\n×¢×›×©×™×• ×”×©××œ×” ×”××—×¨×•× ×” - ××ª×™ ×× ×™ ××©×œ×— ×œ×š ×”×ª×¨××•×ª ×¢×œ ×˜×¨××¤×™×¡×˜×™×? \U0001F4F2\n\n1.\
      \ \U0001F514 ×¢×œ ×›×œ ×‘×§×©×” ×©××’×™×¢×”\n   (×’× ×× ×–×” ×œ× ×‘×™×¢×“×™× ×©×œ×š - ×ª×”×™×” ×”×¨×‘×” ×”×ª×¨××•×ª! \U0001F4F3)\n\n2. \U0001F3AF ×¨×§ ×˜×¨××¤×™×¡×˜×™×\
      \ ×©× ×•×¡×¢×™× ×œ×™×¢×“×™× ×©×œ×š\n   (×ª×œ ××‘×™×‘, ×™×¨×•×©×œ×™× ×•×›×•' - ×‘×›×œ ×©×¢×”)\n\n3. \U0001F3AFâ° ×™×¢×“×™× ×©×œ×š + ×¨×§ ×‘×©×¢×•×ª ×©××ª×” × ×•×¡×¢\n   (×”×›×™\
      \ ×¨×œ×•×•× ×˜×™! ×œ××©×œ: ×¨×§ ×ª×œ ××‘×™×‘ 07:00-09:00)"
    expected_input: choice
    options:
      '1':
        label: ğŸ”” ×¢×œ ×”×›×œ
        value: all
        save_to: alert_preference
        next_state: ask_share_name_preference
      '2':
        label: ğŸ¯ ×”×™×¢×“×™× ×©×œ×™ ×‘×œ×‘×“
        value: my_destinations
        save_to: alert_preference
        next_state: ask_share_name_preference
      '3':
        label: ğŸ¯â° ×™×¢×“×™× + ×©×¢×•×ª (××•××œ×¥!)
        value: my_destinations_and_times
        save_to: alert_preference
        next_state: ask_share_name_preference
  ask_share_name_preference:
    id: ask_share_name_preference
    message: '×›×©×××¦× ×œ×š ×˜×¨××¤×™×¡×˜ ××ª××™× - ×× ×™ ××•×›×œ ×œ×©×œ×•×— ×œ×• ××ª ×”×¤×¨×˜×™× ×©×œ×š ×™×©×™×¨×•×ª? ğŸ“²


      1. ×‘×˜×—! ğŸ‘

      2. ××¢×“×™×£ ×©×ª×©××œ ××•×ª×™ ×œ×¤× ×™ ğŸ¤”'
    expected_input: choice
    options:
      '1':
        label: ×‘×˜×—! ğŸ‘
        value: always
        save_to: share_name_with_hitchhiker
        message: '××¢×•×œ×”! ğŸ‘


          ×× ×™ ××©×œ×— ××ª ×”×¤×¨×˜×™× ×©×œ×š ×œ×˜×¨××¤×™×¡×˜×™× ×™×©×™×¨×•×ª ×›×©×××¦× ×”×ª×××”.'
        next_state: registration_complete
      '2':
        label: ××¢×“×™×£ ×©×ª×©××œ ××•×ª×™ ×œ×¤× ×™ ğŸ¤”
        value: ask
        save_to: share_name_with_hitchhiker
        message: '×‘×¡×“×¨! ğŸ‘


          ×× ×™ ××©××œ ××•×ª×š ×‘×›×œ ×¤×¢× ×œ×¤× ×™ ×©××©×œ×— ××ª ×”×¤×¨×˜×™× ×©×œ×š.'
        next_state: registration_complete
  ask_alert_frequency:
    id: ask_alert_frequency
    message: "×›××¢×˜ ×¡×™×™×× ×•! \U0001F3C1\n\n×¢×›×©×™×• ×‘×•× × ×§×‘×¢ - ×¢×œ ××™×–×” ×‘×§×©×•×ª ×˜×¨××¤ ×× ×™ ××©×œ×— ×œ×š ×”×ª×¨××”? \U0001F4F2\n\n1. \U0001F30D\
      \ ×¢×œ ×›×œ ×‘×§×©×”!\n   (×’× ×× ×–×” ×¨×—×•×§ ×××š - ×ª×”×™×” ×”×¨×‘×” ×”×ª×¨××•×ª!)\n\n2. \U0001F4CD ×¨×§ ×‘×§×©×•×ª ×‘××™×–×•×¨ ×©×œ×™\n   (×œ××©×œ: ×¨×§ ×¦×¤×•×Ÿ, ×¨×§\
      \ ××¨×›×–... ×‘×›×œ ×©×¢×”)\n\n3. \U0001F4CDâ° ××™×–×•×¨ ×©×œ×™ + ×‘×©×¢×•×ª ×©××ª××™××•×ª ×œ×™\n   (×”×›×™ ×¨×œ×•×•× ×˜×™! ×¨×§ ×›×©××ª×” ×‘×××ª ×™×›×•×œ ×œ×ª×ª ×˜×¨××¤)\n\n\
      4. \U0001F515 ×‘×œ×™ ×”×ª×¨××•×ª\n   (×× ×™ ××›× ×¡ ×œ×‘×•×˜ ×›×©×× ×™ ×¨×•×¦×”)"
    expected_input: choice
    options:
      '1':
        label: ğŸŒ ×”×›×œ!
        value: all
        save_to: alert_frequency
        next_state: registration_complete
      '2':
        label: ğŸ“ ××™×–×•×¨ ×©×œ×™ ×‘×œ×‘×“
        value: specific_area_any_time
        save_to: alert_frequency
        next_state: registration_complete
      '3':
        label: ğŸ“â° ××™×–×•×¨ + ×©×¢×•×ª (××•××œ×¥!)
        value: specific_area_and_time
        save_to: alert_frequency
        next_state: registration_complete
      '4':
        label: ğŸ”• ×‘×œ×™ ×”×ª×¨××•×ª
        value: none
        save_to: alert_frequency
        next_state: registration_complete
  registration_complete:
    id: registration_complete
    message: '×™××œ×œ×”! ğŸ‰ğŸŠ ×¡×™×™×× ×•!


      ×”×”×¨×©××” ×”×•×©×œ××” ×‘×”×¦×œ×—×”! âœ…


      ğŸ“‹ ×”××™×“×¢ ×©×œ×š:

      {user_summary}


      ××¢×›×©×™×• ×× ×™ ×›××Ÿ ×‘×©×‘×™×œ×š 24/7! ğŸš—ğŸ’ª

      ×›×œ ×¤×¢× ×©×ª×¦×˜×¨×š ×¢×–×¨×” - ×¤×©×•×˜ ×ª×›×ª×•×‘ ×œ×™! ğŸ˜Š


      ×™×© ×˜×¨××¤! ğŸš™ğŸ’¨


      ×›×©×ª×¦×˜×¨×š ×˜×¨××¤ ××• ×ª×¨×¦×” ×œ×”×¦×™×¢ ×˜×¨××¤ - ×¤×©×•×˜ ×›×ª×•×‘ ×œ×™ "×©×œ×•×" ×•×× ×™ ××¢×–×•×¨ ×œ×š! ğŸ˜Š'
    action: complete_registration
    next_state: idle
  registered_user_menu:
    id: registered_user_menu
    # Removed user_type_is_both condition - always check driver or hitchhiker
    next_state: check_driver_or_hitchhiker
  check_driver_or_hitchhiker:
    id: check_driver_or_hitchhiker
    condition: user_is_driver
    next_state: registered_driver_menu
    else_next_state: registered_hitchhiker_menu
  registered_driver_menu:
    id: registered_driver_menu
    message: "×”×™×™ {full_name}! \U0001F44B\U0001F60A\n\n×©××— ×œ×¨××•×ª ××•×ª×š ×©×•×‘! \U0001F697âœ¨\n\n\U0001F4CB ×”××™×“×¢ ×©×œ×š:\n{user_summary}\n\
      \n××” ×ª×¨×¦×” ×œ×¢×©×•×ª ×”×™×•×?\n\n1. \U0001F504 ×œ×¢×“×›×Ÿ ×©×’×¨×ª × ×¡×™×¢×•×ª\n   (×œ×©× ×•×ª ×™×¢×“×™×, ×™××™× ××• ×©×¢×•×ª)\n\n2. \U0001F697 ×œ×”×•×“×™×¢ ×©×× ×™\
      \ ×¢×•××“ ×œ×¦××ª ×‘×§×¨×•×‘\n   (×™×© ×œ×™ ××§×•× ×¤× ×•×™ ×‘× ×¡×™×¢×”)\n\n3. \U0001F4CB ×”×¦×’ ××ª ×”××™×“×¢ ×©×œ×™\n\n4. â“ ×¢×–×¨×”\n\n5. \U0001F504 ×œ×”×ª×—×™×œ\
      \ ×”×›×œ ××—×“×©\n   (××™×¤×•×¡ ××œ×)"
    expected_input: choice
    options:
      '1':
        label: ğŸ”„ ×¢×“×›×•×Ÿ ×©×’×¨×”
        value: update_routine
        next_state: ask_has_routine
      '2':
        label: ğŸš— ×¢×•××“ ×œ×¦××ª
        value: leaving_soon
        next_state: ask_driver_when_leaving
      '3':
        label: ğŸ“‹ ×”×¦×’ ××ª ×”××™×“×¢ ×©×œ×™
        value: show_info
        next_state: show_my_info
      '4':
        label: â“ ×¢×–×¨×”
        value: help
        action: show_help_command
      '5':
        label: ğŸ”„ ×”×ª×—×œ ××—×“×©
        value: restart
        action: restart_user
  registered_hitchhiker_menu:
    id: registered_hitchhiker_menu
    message: "×”×™×™ {full_name}! \U0001F44B\U0001F60A\n\n×©××— ×œ×¨××•×ª ××•×ª×š ×©×•×‘! \U0001F697âœ¨\n\n\U0001F4CB ×”××™×“×¢ ×©×œ×š:\n{user_summary}\n\
      \n××” ×ª×¨×¦×” ×œ×¢×©×•×ª ×”×™×•×?\n\n1. \U0001F6B6 ××—×¤×© ×˜×¨××¤!\n   (×¦×¨×™×š ×œ×”×’×™×¢ ×œ××™×–×©×”×• ××§×•×)\n\n2. \U0001F4CB ×”×¦×’ ××ª ×”××™×“×¢ ×©×œ×™\n\n\
      3. â“ ×¢×–×¨×”\n\n4. \U0001F504 ×œ×”×ª×—×™×œ ×”×›×œ ××—×“×©\n   (××™×¤×•×¡ ××œ×)"
    expected_input: choice
    options:
      '1':
        label: ğŸš¶ ××—×¤×© ×˜×¨××¤
        value: search_ride
        next_state: ask_hitchhiker_when_need_ride
      '2':
        label: ğŸ“‹ ×”×¦×’ ××ª ×”××™×“×¢ ×©×œ×™
        value: show_info
        next_state: show_my_info
      '3':
        label: â“ ×¢×–×¨×”
        value: help
        action: show_help_command
      '4':
        label: ğŸ”„ ×”×ª×—×œ ××—×“×©
        value: restart
        action: restart_user
  registered_both_menu:
    id: registered_both_menu
    message: "×”×™×™ {full_name}! \U0001F44B\U0001F60A\n\n×©××— ×œ×¨××•×ª ××•×ª×š ×©×•×‘! \U0001F697âœ¨\n\n\U0001F4CB ×”××™×“×¢ ×©×œ×š:\n{user_summary}\n\
      \n××” ×ª×¨×¦×” ×œ×¢×©×•×ª ×”×™×•×?\n\n1. \U0001F6B6 ××—×¤×© ×˜×¨××¤\n   (×¦×¨×™×š ×œ×”×’×™×¢ ×œ××§×•×)\n\n2. \U0001F697 × ×•×ª×Ÿ ×˜×¨××¤\n   (×¢×•××“ ×œ×¦××ª ×‘×§×¨×•×‘)\n\
      \n3. \U0001F504 ×¢×“×›×•×Ÿ ×©×’×¨×ª × ×¡×™×¢×•×ª\n   (×œ×©× ×•×ª ×™×¢×“×™×, ×™××™× ××• ×©×¢×•×ª)\n\n4. \U0001F4CB ×”×¦×’ ××ª ×”××™×“×¢ ×©×œ×™\n\n5. â“ ×¢×–×¨×”\n\n\
      6. \U0001F504 ×”×ª×—×œ ××—×“×©\n   (××™×¤×•×¡ ××œ×)"
    expected_input: choice
    options:
      '1':
        label: ğŸš¶ ××—×¤×© ×˜×¨××¤
        value: search_ride
        next_state: ask_hitchhiker_when_need_ride
      '2':
        label: ğŸš— × ×•×ª×Ÿ ×˜×¨××¤
        value: offer_ride
        next_state: ask_driver_when_leaving
      '3':
        label: ğŸ”„ ×¢×“×›×•×Ÿ ×©×’×¨×”
        value: update_routine
        next_state: ask_has_routine
      '4':
        label: ğŸ“‹ ×”×¦×’ ××ª ×”××™×“×¢ ×©×œ×™
        value: show_info
        next_state: show_my_info
      '5':
        label: â“ ×¢×–×¨×”
        value: help
        action: show_help_command
      '6':
        label: ğŸ”„ ×”×ª×—×œ ××—×“×©
        value: restart
        action: restart_user
  ask_driver_when_leaving:
    id: ask_driver_when_leaving
    message: '××¦×•×™×Ÿ! ğŸš—ğŸ’¨


      ××ª×™ ××ª×” ×¢×•××“ ×œ×¦××ª?


      1. âš¡ ×××© ×¢×›×©×™×•

      2. â° ×‘×—×¦×™ ×©×¢×” ×”×§×¨×•×‘×”

      3. â±ï¸ ×‘×©×¢×” ×”×§×¨×•×‘×”

      4. ğŸ• ×‘×©×¢×•×ª ×”×§×¨×•×‘×•×ª (2-5 ×©×¢×•×ª)'
    expected_input: choice
    options:
      '1':
        label: âš¡ ×××© ×¢×›×©×™×•
        value: now
        next_state: ask_driver_destination
      '2':
        label: â° ×‘×—×¦×™ ×©×¢×”
        value: 30min
        next_state: ask_driver_destination
      '3':
        label: â±ï¸ ×‘×©×¢×”
        value: 1hour
        next_state: ask_driver_destination
      '4':
        label: ğŸ• 2-5 ×©×¢×•×ª
        value: 2-5hours
        next_state: ask_driver_destination
    save_to: departure_timing
  ask_driver_destination:
    id: ask_driver_destination
    message: '××¢×•×œ×”! ğŸ¯


      ×œ××Ÿ ××ª×” ×¢×•××“ ×œ× ×¡×•×¢?


      (×›×ª×•×‘ ××ª ×©× ×”×™×¢×“)

      ğŸ’¡ ×œ××©×œ: ×™×¨×•×©×œ×™×, ×ª×œ ××‘×™×‘, ×—×™×¤×”, ×‘××¨ ×©×‘×¢...'
    expected_input: text
    save_to: driver_destination
    next_state: confirm_driver_ride_offer
  confirm_driver_ride_offer:
    id: confirm_driver_ride_offer
    message: '×ª×•×“×” ×¨×‘×”! ğŸ™âœ¨


      ×”× ×¡×™×¢×” ×©×œ×š × ×¨×©××” ×‘××¢×¨×›×ª!


      ğŸ“‹ ×”××™×“×¢ ×©×œ×š:

      {user_summary}


      ×˜×¨××¤×™×¡×˜×™× ××ª××™××™× ×™×§×‘×œ×• ×”×ª×¨××” ×ª×•×š ×›××” ×“×§×•×ª ğŸ“²


      × ×¡×™×¢×” ×‘×˜×•×—×”! ğŸš—ğŸ’¨'
    action: save_driver_ride_offer
    next_state: idle
  ask_hitchhiker_when_need_ride:
    id: ask_hitchhiker_when_need_ride
    message: '×‘×¡×“×¨! ğŸš¶ğŸ’¨


      ×œ××ª×™ ××ª×” ×¦×¨×™×š ××ª ×”×˜×¨××¤?


      1. âš¡ ×××© ×¢×›×©×™×•

      2. â° ×‘×—×¦×™ ×©×¢×” ×”×§×¨×•×‘×”

      3. â±ï¸ ×‘×©×¢×” ×”×§×¨×•×‘×”

      4. ğŸ• ×‘×©×¢×•×ª ×”×§×¨×•×‘×•×ª (2-5 ×©×¢×•×ª)'
    expected_input: choice
    options:
      '1':
        label: âš¡ ×××© ×¢×›×©×™×•
        value: now
        next_state: ask_hitchhiker_destination
      '2':
        label: â° ×‘×—×¦×™ ×©×¢×”
        value: 30min
        next_state: ask_hitchhiker_destination
      '3':
        label: â±ï¸ ×‘×©×¢×”
        value: 1hour
        next_state: ask_hitchhiker_destination
      '4':
        label: ğŸ• 2-5 ×©×¢×•×ª
        value: 2-5hours
        next_state: ask_hitchhiker_destination
    save_to: ride_timing
  ask_hitchhiker_destination:
    id: ask_hitchhiker_destination
    message: '××¦×•×™×Ÿ! ğŸ¯


      ×œ××Ÿ ××ª×” ×¦×¨×™×š ×œ×”×’×™×¢?


      (×›×ª×•×‘ ××ª ×©× ×”×™×¢×“)

      ğŸ’¡ ×œ××©×œ: ×™×¨×•×©×œ×™×, ×ª×œ ××‘×™×‘, ×—×™×¤×”, ×‘××¨ ×©×‘×¢...'
    expected_input: text
    save_to: hitchhiker_destination
    next_state: confirm_hitchhiker_ride_request
  confirm_hitchhiker_ride_request:
    id: confirm_hitchhiker_ride_request
    message: '×™××œ×œ×”! ğŸ‰


      ×”×‘×§×©×” ×©×œ×š × ×¨×©××” ×‘××¢×¨×›×ª!


      ğŸ“‹ ×”××™×“×¢ ×©×œ×š:

      {user_summary}


      ×× ×™ ××—×¤×© ×œ×š × ×”×’ ××ª××™× ×¢×›×©×™×•... ğŸ”ğŸš—

      ×× ×××¦× × ×”×’ ××ª××™× - ×ª×§×‘×œ ×”×ª×¨××” ×ª×•×š ×›××” ×“×§×•×ª! ğŸ“²'
    action: save_hitchhiker_ride_request
    next_state: idle
  ask_destination_registered:
    id: ask_destination_registered
    message: '××•×§×™×™! ×‘×•× × ××¦× ×œ×š ×˜×¨××¤! ğŸš—ğŸ’¨


      ××ª×” × ×•×¡×¢ ×œ×™×¢×“ ×”×§×‘×•×¢ ×©×œ×š ({default_destination})? ğŸ¯


      1. âœ… ×›×Ÿ, ×›×¨×’×™×œ!

      2. ğŸ”„ ×œ×, ×™×¢×“ ××—×¨ ×”×¤×¢×'
    expected_input: choice
    condition: has_default_destination
    options:
      '1':
        label: âœ… ×›×Ÿ, ×›×¨×’×™×œ
        value: 'yes'
        action: use_default_destination
        next_state: ask_when
      '2':
        label: ğŸ”„ ×œ×, ×™×¢×“ ××—×¨
        value: 'no'
        next_state: ask_destination
    else_next_state: ask_destination
  ask_offer_ride_details:
    id: ask_offer_ride_details
    message: '××¢×•×œ×”! ×ª×•×“×” ×©××ª×” × ×•×ª×Ÿ ×˜×¨××¤! ğŸ™ğŸš—


      ×‘×•× × ×¤×¨×¡× ××ª ×”× ×¡×™×¢×” ×©×œ×š:


      ×›×ª×•×‘ ××ª ×¤×¨×˜×™ ×”× ×¡×™×¢×”:

      ğŸ’¡ ×œ××©×œ: "× ×•×¡×¢ ××ª×œ ××‘×™×‘ ×œ×™×¨×•×©×œ×™× ×”×™×•× ×‘-14:00, ×™×© 2 ××§×•××•×ª ×¤× ×•×™×™×"


      ××• ×¡×¤×¨ ×œ×™:

      â€¢ ×××™×¤×” ××ª×” ×™×•×¦×?

      â€¢ ×œ××Ÿ ××ª×” × ×•×¡×¢?

      â€¢ ××ª×™?

      â€¢ ×›××” ××§×•××•×ª ×¤× ×•×™×™×?'
    expected_input: text
    save_to: ride_offer_details
    next_state: confirm_ride_offer
    action: save_ride_offer
  confirm_ride_offer:
    id: confirm_ride_offer
    message: '×ª×•×“×” ×¨×‘×”! ğŸ™âœ¨


      ×”× ×¡×™×¢×” ×©×œ×š ×¤×•×¨×¡××”!


      ×˜×¨××¤×™×¡×˜×™× ××ª××™××™× ×™×§×‘×œ×• ×”×ª×¨××” ğŸ“²


      ×× ××™×©×”×• ××¢×•× ×™×™×Ÿ - × ×¢×“×›×Ÿ ××•×ª×š! ğŸ˜Š


      × ×¡×™×¢×” ×‘×˜×•×—×”! ğŸš—ğŸ’¨'
    next_state: idle
  show_help_menu:
    id: show_help_menu
    message: 'ğŸ“– ××“×¨×™×š ×©×™××•×© ×‘×”×™×™×§×¨


      ğŸš¶ *×œ××—×¤×©×™ ×˜×¨××¤:*

      1. ×œ×—×¥ ×¢×œ "××—×¤×© ×˜×¨××¤"

      2. ×‘×—×¨ ×™×¢×“ ×•×©×¢×”

      3. ×ª×§×‘×œ ×”×ª×¨××” ×›×©× ××¦× × ×”×’!


      ğŸš— *×œ× ×”×’×™×:*

      1. ×œ×—×¥ ×¢×œ "×œ×ª×ª ×˜×¨××¤" ×›×©××ª×” × ×•×¡×¢

      2. ××• ×”×’×“×¨ "×©×’×¨×ª × ×¡×™×¢×•×ª" ×œ××¡×œ×•×œ×™× ×§×‘×•×¢×™×

      3. ×ª×§×‘×œ ×”×ª×¨××•×ª ×¢×œ ×˜×¨××¤×™×¡×˜×™× ××ª××™××™×!


      âœ¨ *×˜×™×¤×™×:*

      â€¢ ×›×›×œ ×©×ª×”×™×” ×™×•×ª×¨ ×’××™×© ×¢× ×©×¢×•×ª - ×™×•×ª×¨ ×¡×™×›×•×™ ×œ×”×ª×××”

      â€¢ ×¢×“×›×Ÿ ××ª ×”×©×’×¨×” ×©×œ×š ×›×“×™ ×œ×§×‘×œ ×”×ª×¨××•×ª ×¨×œ×•×•× ×˜×™×•×ª

      â€¢ ××¤×©×¨ ×ª××™×“ ×œ×›×ª×•×‘ "×ª×¤×¨×™×˜" ×›×“×™ ×œ×—×–×•×¨ ×œ×ª×¤×¨×™×˜ ×”×¨××©×™


      ğŸ’¬ *×¤×§×•×“×•×ª ×©×™××•×©×™×•×ª:*

      â€¢ ×ª×¤×¨×™×˜ - ×—×–×¨×” ×œ×ª×¤×¨×™×˜

      â€¢ ×—×“×© - ×”×ª×—×œ×” ××—×“×©

      â€¢ ×—×–×•×¨ - ×—×–×¨×” ×©×œ×‘ ××—×•×¨×”

      â€¢ ×¢×–×¨×” - ×”××“×¨×™×š ×”×–×”


      ×™×© ×¢×•×“ ×©××œ×•×ª? ×¤×©×•×˜ ×›×ª×•×‘! ğŸ˜Š'
    next_state: idle
  ask_trip_planning:
    id: ask_trip_planning
    message: '×™×•×¤×™! ×‘×•× × ×ª×›× ×Ÿ ××ª ×”× ×¡×™×¢×” ×©×œ×š ××¨××©! ğŸ“âœ¨


      (×–×” ×©×•× ×” ××‘×§×©×ª ×˜×¨××¤ ×¨×’×™×œ×” - ×›××Ÿ ××ª×” ××ª×›× ×Ÿ ××¨××©

      ×•×× ×™ ××–×›×™×¨ ×œ×š ×œ×”×–××™×Ÿ ×˜×¨××¤ ×›×©×”×–××Ÿ ××ª×§×¨×‘! ğŸ””)


      ×¤×©×•×˜ ×ª××¨ ×œ×™ ××ª ×”× ×¡×™×¢×”:


      ğŸ’¡ ×“×•×’×××•×ª:

      â€¢ × ×¡×™×¢×” ×œ×™×¨×•×©×œ×™× ××—×¨ ×‘-08:00

      â€¢ ×˜×™×•×œ ×œ××™×œ×ª ×‘×™×•× ×—××™×©×™

      â€¢ × ×¡×™×¢×” ×œ×—×™×¤×” ×‘×¡×•×£ ×”×©×‘×•×¢'
    expected_input: text
    save_to: planned_trip
    next_state: confirm_trip_saved
    action: save_planned_trip
  ask_what_to_update:
    id: ask_what_to_update
    message: '×‘×¡×“×¨! ×‘×•× × ×¢×“×›×Ÿ ××ª ×”×¤×¨×˜×™× ×©×œ×š! âœï¸


      ××” ×ª×¨×¦×” ×œ×©× ×•×ª?


      1. ğŸ‘¤ ×©×

      2. ğŸ¯ ×™×¢×“×™× ×§×‘×•×¢×™×

      3. ğŸ”” ×”×¢×“×¤×•×ª ×”×ª×¨×¢×•×ª'
    expected_input: choice
    options:
      '1':
        label: ğŸ‘¤ ×©×
        value: name
        next_state: update_full_name
      '2':
        label: ğŸ¯ ×™×¢×“×™×
        value: destinations
        next_state: ask_routine_destination
      '3':
        label: ğŸ”” ×”×ª×¨×¢×•×ª
        value: alerts
        next_state: ask_alert_preference
  update_full_name:
    id: update_full_name
    message: '××•×§×™×™! âœï¸


      ××” ×”×©× ×”×—×“×© ×©×œ×š?


      (×›×ª×•×‘ ××ª ×”×©× ×”××œ×)'
    expected_input: text
    save_to: full_name
    next_state: show_my_info
  confirm_trip_saved:
    id: confirm_trip_saved
    message: '××•×©×œ×! ğŸ‰


      ×”× ×¡×™×¢×” ×©×œ×š × ×©××¨×” ×‘××¢×¨×›×ª! âœ…


      ××¢×“×›×Ÿ ××•×ª×š ×‘×¨×’×¢ ×©×™×”×™×• ×”×ª×××•×ª! ğŸ“²


      × ×¡×™×¢×” ×˜×•×‘×”! ğŸš—ğŸ’¨'
    next_state: idle
  idle:
    id: idle
    action: return_to_idle
  confirm_restart:
    id: confirm_restart
    message: 'âš ï¸ ××ª×” ×‘×˜×•×— ×©××ª×” ×¨×•×¦×” ×œ×”×ª×—×™×œ ××—×“×©?


      ×–×” ×™××—×§ ××ª ×›×œ ×”××™×“×¢ ×©×œ×š! ğŸ˜±


      1. âœ… ×›×Ÿ, ×× ×™ ×‘×˜×•×—

      2. âŒ ×œ×, ×× ×™ ×¨×•×¦×” ×œ×—×–×•×¨'
    expected_input: choice
    options:
      '1':
        label: âœ… ×›×Ÿ, ×× ×™ ×‘×˜×•×—
        value: 'yes'
        action: restart_user
      '2':
        label: âŒ ×œ×, ×—×–×•×¨
        value: 'no'
        next_state: registered_user_menu
  show_my_info:
    id: show_my_info
    message: 'ğŸ“‹ ×”××™×“×¢ ×©×œ×š:


      {user_summary}


      ××” ×ª×¨×¦×” ×œ×¢×©×•×ª?


      1. âœï¸ ×œ×¢×¨×•×š ×¤×¨×˜×™×

      2. âœ… ×”×›×œ ×‘×¡×“×¨, ×—×–×•×¨ ×œ×ª×¤×¨×™×˜'
    expected_input: choice
    options:
      '1':
        label: âœï¸ ×œ×¢×¨×•×š ×¤×¨×˜×™×
        value: edit
        next_state: ask_what_to_update
      '2':
        label: âœ… ×—×–×•×¨ ×œ×ª×¤×¨×™×˜
        value: back_to_menu
        next_state: registered_user_menu
commands:
  ×—×–×•×¨: go_back
  back: go_back
  ××—×•×¨×”: go_back
  ×—×“×©: restart
  restart: restart
  ××—×§: delete_data
  ×¢×–×¨×”: show_help
  help: show_help
  ×ª×¤×¨×™×˜: show_menu
  menu: show_menu
